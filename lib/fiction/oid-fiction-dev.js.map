{"version":3,"file":"oid-fiction-dev.js","sources":["../../src/fiction/components/lively-talk-oid.js"],"sourcesContent":["import { html, css, Oid, OidUI } from '/lib/foundation/oidlib-dev.js'\n\nexport class LivelyTalkOid extends OidUI {\n  async connectedCallback () {\n    await super.connectedCallback()\n    this.handleSend()\n  }\n\n  handleProcess (topic, message) {\n    this._callCustom('process', message)\n  }\n\n  handleSend (topic, message) {\n    let fspeech = this.speech || ''\n    if (message) {\n      if (fspeech.includes('{{')) {\n        fspeech = fspeech.replace(\n          /{{[ \\t]*([^}]*)}}/g,\n          (match, p1) => {\n            p1 = (p1) ? p1.trim() : 'value'\n            let value = (message[p1]) ? message[p1] : ''\n            return value\n          })\n      } else if (message.value)\n        fspeech += message.value.replace(/\\n/g, '<br>')\n    } else\n      fspeech = fspeech.replace(/{{[ \\t]*[^}]*}}/g, '')\n    this._presentation.querySelector('#speech').innerHTML = fspeech\n    this._notify('update', {value: fspeech})\n  }\n\n  handleClear () {\n    this._presentation.querySelector('#speech').innerHTML = ''\n  }\n}\n\nOid.component({\n  id: 'foid:lively-talk',\n  element: 'lively-talk-oid',\n  properties: {\n    character: {default: 'assets:images/dino.svg'},\n    bubble: {default: 'assets:images/bubble-landscape.svg'},\n    speech: {}\n  },\n  receive: {\n    'process': 'handleProcess',\n    'display': 'handleSend',\n    'clear': 'handleClear'\n  },\n  provide: ['itf:transfer'],\n  implementation: LivelyTalkOid,\n  styles: css`\n  .character {\n    width: 128px;\n  }\n  .bubble {\n    background-repeat: no-repeat;\n    background-size: 100% 100%;\n    flex-basis: 100%;\n    padding: 15px 15px 10px 40px;\n    background-image: url(\"{{url:this.bubble}}\");\n  }\n  .speech {\n    font-size: 2.5vh;\n    inline-size: 100%;\n    overflow-wrap: break-word;\n  }`,\n  template: html`\n  <div id=\"oid-prs\" style=\"width:100%;display:flex;flex-direction:row\">\n    <img src=\"{{url:this.character}}\" class=\"character\">\n    <div class=\"bubble\"><div class=\"speech\" id=\"speech\"></div></div>\n  </div>`\n})"],"names":[],"mappings":";AAEO,MAAM,sBAAsB,MAAM;AAAA,EACvC,MAAM,oBAAqB;AACzB,UAAM,MAAM,kBAAiB;AAC7B,SAAK,WAAU;AAAA,EACnB;AAAA,EAEE,cAAe,OAAO,SAAS;AAC7B,SAAK,YAAY,WAAW,OAAO;AAAA,EACvC;AAAA,EAEE,WAAY,OAAO,SAAS;AAC1B,QAAI,UAAU,KAAK,UAAU;AAC7B,QAAI,SAAS;AACX,UAAI,QAAQ,SAAS,IAAI,GAAG;AAC1B,kBAAU,QAAQ;AAAA,UAChB;AAAA,UACA,CAAC,OAAO,OAAO;AACb,iBAAM,KAAM,GAAG,KAAI,IAAK;AACxB,gBAAI,QAAS,QAAQ,EAAE,IAAK,QAAQ,EAAE,IAAI;AAC1C,mBAAO;AAAA,UACR;AAAA,QAAA;AAAA,MACX,WAAiB,QAAQ;AACjB,mBAAW,QAAQ,MAAM,QAAQ,OAAO,MAAM;AAAA,IACjD;AACC,gBAAU,QAAQ,QAAQ,oBAAoB,EAAE;AAClD,SAAK,cAAc,cAAc,SAAS,EAAE,YAAY;AACxD,SAAK,QAAQ,UAAU,EAAC,OAAO,QAAO,CAAC;AAAA,EAC3C;AAAA,EAEE,cAAe;AACb,SAAK,cAAc,cAAc,SAAS,EAAE,YAAY;AAAA,EAC5D;AACA;AAEA,IAAI,UAAU;AAAA,EACZ,IAAI;AAAA,EACJ,SAAS;AAAA,EACT,YAAY;AAAA,IACV,WAAW,EAAC,SAAS,yBAAwB;AAAA,IAC7C,QAAQ,EAAC,SAAS,qCAAoC;AAAA,IACtD,QAAQ,CAAA;AAAA,EACT;AAAA,EACD,SAAS;AAAA,IACP,WAAW;AAAA,IACX,WAAW;AAAA,IACX,SAAS;AAAA,EACV;AAAA,EACD,SAAS,CAAC,cAAc;AAAA,EACxB,gBAAgB;AAAA,EAChB,QAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAgBR,UAAU;AAAA;AAAA;AAAA;AAAA;AAKZ,CAAC;"}